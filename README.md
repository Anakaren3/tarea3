SELECT RAMO, A.Poliza,
B.[PRIMA NETA ENDOSO] as 'SumaPrimaNetaPositiva', 
B.SumaPrimaNetaNegativa,
B.[PRIMA NETA ENDOSO]
FROM (
SELECT RAMO, POLIZA, 'MENSUAL' AS 'FORMA DE PAGO','-' AS 'Prima de Renovación o Primer año',  CC , [Descripcion ]
FROM C_POLIZA_RESUMEN WHERE Poliza IN (
50, 16190027
) 
	)A
INNER JOIN ( SELECT  POLIZA, 
SUM (CAST([PRIMA NETA ENDOSO] AS FLOAT)) AS [PRIMA NETA ENDOSO],
SUM(CASE WHEN CAST([PRIMA NETA ENDOSO] AS FLOAT) >= 0 THEN  CAST([PRIMA NETA ENDOSO] AS FLOAT) ELSE 0 END) as SumaPrimaNetaPositiva,
SUM(CASE WHEN CAST([PRIMA NETA ENDOSO] AS FLOAT) < 0 THEN CAST([PRIMA NETA ENDOSO] AS FLOAT) ELSE 0 END) as SumaPrimaNetaNegativa
FROM  TAB_ENSOSOS2023_PRUEBA WHERE  Poliza IN (
50, 16190027

)  GROUP BY  POLIZA
	) B 
ON A.POLIZA = B.POLIZA
